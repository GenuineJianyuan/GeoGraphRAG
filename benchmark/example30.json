{
    "query": "Analyze water area changes",
    "datasource": [
        "Landsat8 image",
        "Region of interest vector data"
    ],
    "raw_code": "var geometry = ee.Geometry.Polygon([[[99.58525333814976,37.24714673441345],[100.77704556952716,37.24714673441345],[100.7667704556952716,36.528174170711736],[99.58525333814976,36.528174170711736],[99.58525333814976,37.24714673441345]]]);\n\nfunction processImage(year, roi) {\n  var l8Col = ee.ImageCollection('LANDSAT/LC08/C01/T1_SR')\n    .filterBounds(roi)\n    .filterDate(ee.Date.fromYMD(year,1,1), ee.Date.fromYMD(year,12,31))\n    .select(['B3','B5','QA60'])\n    .map(function(image){\n      var ndwi = image.select('B3').subtract(image.select('B5')).divide(image.select('B3').add(image.select('B5'))).rename('NDWI');\n      var cloudMask = image.select('QA60').bitwiseAnd(1<<4).eq(0);\n      return ndwi.updateMask(cloudMask).updateMask(ndwi.gt(0.3));\n    });\n  return l8Col.max().clip(roi);\n}\n\nfunction calcArea(yearImg, roi) {\n  return yearImg.multiply(ee.Image.pixelArea()).gt(0.3)\n    .reduceRegion({\n      reducer: ee.Reducer.sum(),\n      geometry: roi,\n      scale: 30,\n      maxPixels: 1e8\n    }).get('NDWI');\n}",
    "api": [
        "ee.Geometry.Polygon",
        "ee.ImageCollection.filterBounds",
        "ee.ImageCollection.filterDate",
        "ee.ImageCollection.select",
        "ee.ImageCollection.map",
        "ee.Image.subtract",
        "ee.Image.divide",
        "ee.Image.rename",
        "ee.Image.bitwiseAnd",
        "ee.Image.eq",
        "ee.Image.updateMask",
        "ee.Image.gt",
        "ee.ImageCollection.max",
        "ee.Image.clip",
        "ee.Image.multiply",
        "ee.Image.pixelArea",
        "ee.Image.reduceRegion",
        "ee.Reducer.sum",
        "ee.Image.get"
    ],
    "processing step": [
        "Define a polygon geometry as the region of interest.",
        "Filter Landsat 8 images by date and region.",
        "Select specific bands (B3, B5, QA60) from the images.",
        "Calculate NDWI using B3 and B5 bands.",
        "Apply cloud mask using QA60 band.",
        "Mask NDWI values less than 0.3.",
        "Clip the processed image to the region of interest.",
        "Calculate the area with NDWI greater than 0.3.",
        "Sum the area using pixel area and reduce region."
    ],
    "output": "Numerical output: water surface area."
}